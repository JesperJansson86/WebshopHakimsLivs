<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6"
      crossorigin="anonymous"
    />
    <script
      src="https://code.jquery.com/jquery-3.6.0.js"
      integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
      crossorigin="anonymous"
    ></script>
    <title>HakimLivs</title>
  </head>

  <body style="background-color: rgb(197, 221, 197)">
    <!-- Header/ huvudmenyn -->

      <div class="row">
        <header class="col px-0" id="header"></header>
      </div>

      <!-- ./ header -->

      <!-- Sidomenyn -->
      <div class="container" >
        <div class="row">
          <div class="col-md-3" id="sidebar"></div>
          <!-- ./ sidomeny -->

          <!-- Main -->
          <div class="col-md-9">
            <h1 style="color: rgb(3, 78, 3)" id="titleOfPage">Välkommen!</h1>
            <p>Visar 6 slumpvis utvalda produkter</p>

            <div id="contentOfPage">
              <div class="row mt-5" id="card"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- ./ main -->

    <!-- footer/ information-->
    <div class="row">
      <footer class="col"></footer>
    </div>
    <!-- ./ footer/ information-->

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
      crossorigin="anonymous"
    ></script>
    <script src="../javascript/barsStandard.js"></script>

    <script>
      /**
       * Slumpar fram 6st synliga produkter från Json fil
       * */
      let getFromLS = JSON.parse(localStorage.getItem("Knapp"));
         
      $.getJSON("../json/products1.json", function (value) {
        var visibleProducts = [];
        $.each(value, function (key, value) {
          if (value.visible) {
            visibleProducts.push(value);
          }
        })
        var displayedProducts = 6;
          for (var i = 0; i < displayedProducts; i++) {
            var product = visibleProducts[Math.floor(Math.random() * visibleProducts.length)];
            //Tar bort framslumpad product ur arrayen så att inga dubbletter visas
            var removeIndex = visibleProducts.map(prod => prod.id).indexOf(product.id);
            visibleProducts.splice(removeIndex, 1);
            
              document.getElementById("card").innerHTML += `
            <div class="col-md-6 col-lg-4">
              <div class="card text-dark border-success bg-light mb-3">
                      
                <div class="card-body">
                  <h5 class="card-title">${product.name}</h5>

                  <img src="https://raw.githubusercontent.com/JesperJansson86/WebshopHakimsLivs/S01-4/Testdata/img/${
                    product.image
                  }" class="img-fluid">

                  <p class="card-text">${product.description}</p>
                </div>
                    

                <div class="card-body text-end">
                  <p>Pris: ${product.price} kr</p>
                  
                  <p class="my-1"><small class="text-muted">Jmfrpris: ${Math.round(
                    (product.price / product.size) * 1000
                  )}/${product.unitId} kr</small></p>
                  <p><small class="text-muted">Lagerstatus: ${Math.round(
                    Math.random() * 10
                  )}</small></p>
                
                  <div class="d-grid gap-2">
                  <a href="#" class="btn btn-primary">Köp</a>
                  </div>
                </div>

              </div>
            </div>
                         `;
            }
      });
    </script>
  </body>
</html>
