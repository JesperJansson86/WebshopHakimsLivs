<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6"
      crossorigin="anonymous"
    />
    <script
      src="https://code.jquery.com/jquery-3.6.0.js"
      integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
      crossorigin="anonymous"
    ></script>
    <title>Startsida</title>
  </head>
  <body class="container-fluid" style="background-color: rgb(197, 221, 197)">
    <div class="row">
      <div class="col px-0">
        <!-- Header/ huvudmenyn -->
        <header></header>
      </div>
    </div>
    <div class="row px-5">
      <div class="col-9">
        <!-- Main -->
        <div
          class="p-3 overflow-auto"
          style="background-color: rgb(197, 221, 197)"
        >
          <h2 style="color: rgb(3, 78, 3)" id="titleOfPage">
            Leverans och betalning
          </h2>
          <div class="card mb-3">
            <div class="card-header">Välj leveranssätt</div>
            <div class="card-body">
              <p style="font-weight: 500">
                Hur vill du få dina varor levererade?
              </p>

              <div id="orderSummary"></div>
              <form id="chooseDeliveryForm">
                <input
                  type="radio"
                  name="deliveryChoice"
                  id="storePickUpChoice"
                />
                Hämta i butik
                <br />
                <input
                  type="radio"
                  name="deliveryChoice"
                  id="homeDeliveryChoice"
                  checked
                />
                Hemleverans
                <br />
              </form>
            </div>
          </div>

          <div class="card">
            <div class="card-header">Vänligen fyll i dina kontaktuppgifter</div>
            <div class="card-body">

              <div id="storePickUp">
                <form
                  name="form"
                  action="confirmation.html"
                  id="storePickUpForm"
                  onsubmit="return submitPickUp()"
                >
                  <div class="mb-3">
                    <label for="firstname" style="font-weight: 500"
                      >Förnamn:</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="pickupFirstname"
                      placeholder="Ange förnamn"
                      name="firstname"
                      style="width: 40%"
                      pattern="[a-zA-ZåäöÅÄÖ]{2,30}"
                    />
                  </div>

                  <div class="mb-3">
                    <label for="lastname" style="font-weight: 500"
                      >Efternamn:</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="pickupLastname"
                      placeholder="Ange efternamn"
                      name="lastname"
                      style="width: 40%"
                      pattern="[a-zA-ZåäöÅÄÖ]{2,30}"
                    />
                  </div>

                  <div class="mb-3">
                    <label for="phonenumber" style="font-weight: 500"
                      >Telefon:</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="pickupPhonenumber"
                      placeholder="Ange telefonnummer"
                      name="phonenumber"
                      style="width: 40%"
                      pattern="[0-9]{5,20}"
                    />
                  </div>

                  <div class="mb-3">
                    <label for="email" style="font-weight: 500">E-post:</label>
                    <input
                      type="email"
                      class="form-control"
                      id="pickupEmail"
                      placeholder="Ange e-post"
                      name="email"
                      style="width: 40%"
                      pattern="[a-z0-9._%+-]{1,64}@[a-z0-9.-]{1,252}\.[a-z]{2,3}"
                    />
                  </div>
                  <input
                    type="submit"
                    name="pickupSubmit"
                    id="pickupSubmit"
                    value="Beställ"
                    class="mt-3"
                  />
                </form>
              </div>

              <div id="homeDelivery">
                <form
                  name="form"
                  action="confirmation.html"
                  id="homeDeliveryForm"
                  onsubmit="return submitDelivery()"
                >
                  <div class="mb-3">
                    <label for="firstname" style="font-weight: 500"
                      >Förnamn:</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="deliveryFirstname"
                      placeholder="Ange förnamn"
                      name="firstname"
                      style="width: 40%"
                      pattern="[a-zA-ZåöäÅÖÄ]{2,30}"
                    />
                  </div>

                  <div class="mb-3">
                    <label for="lastname" style="font-weight: 500"
                      >Efternamn:</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="deliveryLastname"
                      placeholder="Ange efternamn"
                      name="lastname"
                      style="width: 40%"
                      pattern="[a-zA-ZåöäÅÖÄ]{2,30}"
                    />
                  </div>

                  <div class="mb-3">
                    <label for="phonenumber" style="font-weight: 500"
                      >Telefon:</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="deliveryPhonenumber"
                      placeholder="Ange telefonnummer"
                      name="phonenumber"
                      style="width: 40%"
                      pattern="[0-9]{5,20}"
                    />
                  </div>

                  <div class="mb-3">
                    <label for="email" style="font-weight: 500">E-post:</label>
                    <input
                      type="email"
                      class="form-control"
                      id="deliveryEmail"
                      placeholder="Ange e-post"
                      name="email"
                      style="width: 40%"
                      pattern="[a-z0-9._%+-]{1,64}@[a-z0-9.-]{1,252}\.[a-z]{2,3}"
                    />
                  </div>

                  <div class="mb-3">
                    <label for="address" style="font-weight: 500"
                      >Adress:</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="deliveryAddress"
                      placeholder="Ange adress"
                      name="address"
                      style="width: 40%"
                      pattern="[a-zA-ZåöäÅÖÄ]{2,30}"
                    />
                  </div>

                  <div class="mb-3">
                    <label for="zipcode" style="font-weight: 500"
                      >Postnummer:</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="deliveryZipcode"
                      placeholder="Ange postnummer"
                      name="zipcode"
                      style="width: 40%"
                      pattern="[0-9]{5,6}"
                    />
                  </div>

                  <div>
                    <label for="city" style="font-weight: 500">Ort:</label>
                    <input
                      type="text"
                      class="form-control"
                      id="deliveryCity"
                      placeholder="Ange ort"
                      name="city"
                      style="width: 40%"
                      pattern="[a-zA-ZåöäÅÖÄ]{2,30}"
                    />
                  </div>

                  <input
                    type="submit"
                    name="deliverySubmit"
                    id="deliverySubmit"
                    value="Beställ"
                    class="mt-3"
                  />
                </form>
              </div>
              <h3 class="mb-3" style="color: red" id="bigError">
              </h3>
            </div>
          </div>
        </div>
      </div>
      <!-- Kassa sidebar-->
      <div class="col">
        <div class="p-3" style="background-color: rgb(136, 153, 136)">
          <h2 style="color: rgb(3, 78, 3)" id="titleOfPage">Kassan</h2>
          <div class="row">
            <div class="card-header">Sammanfattning</div>
            <div class="card-body">
              <p class="card-text" id="basketValue"></p>
              <p class="card-text" id="deliveryCost"></p>
              <p class="card-text" id="freeDelivery" style="color: greenyellow">
                Handla för minst 500 kr och få gratis leverans
              </p>
              <p class="card-text" id="TotalAmount"></p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col px-0">
        <!-- footer/ information-->
        <footer></footer>
      </div>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
      crossorigin="anonymous"
    ></script>
    <script src="../javascript/barsBasket.js"></script>
    <script>
      localStorage.setItem("deliveryType", "home");


      function submitDelivery() {
        firstname = document.getElementById("deliveryFirstname").value;
        lastname = document.getElementById("deliveryLastname").value;
        phone = document.getElementById("deliveryPhonenumber").value;
        email = document.getElementById("deliveryEmail").value;
        adress = document.getElementById("deliveryAddress").value;
        zip = document.getElementById("deliveryZipcode").value;
        city = document.getElementById("deliveryCity").value;

        if(firstname == "" || lastname == "" || phone == "" || email == "" || adress == "" || zip == "" || city == ""){
          document.getElementById("bigError").innerHTML = "Kontrollera att du fyllt i alla kontaktuppgifter"
          return false;
        }
        
        var parseCustomer = [{
          firstname: firstname,
          lastname: lastname,
          phone: phone,
          email: email,
          adress: adress,          
          zip: zip,
          city: city,
        }];
        var customerJSON = JSON.stringify(parseCustomer);
        console.log(customerJSON);
        localStorage.setItem("customerName", firstname + " "+ lastname);

        
        return true;
      }

      function submitPickUp() {
        firstname = document.getElementById("pickupFirstname").value;
        lastname = document.getElementById("pickupLastname").value;
        phone = document.getElementById("pickupPhonenumber").value;
        email = document.getElementById("pickupEmail").value;

        if(firstname == "" || lastname == "" || phone == "" || email == ""){
          document.getElementById("bigError").innerHTML = "Kontrollera att du fyllt i alla kontaktuppgifter"
          return false;
        }
        
        var parseCustomer = [{
          firstname: firstname,
          lastname: lastname,
          phone: phone,
          email: email,

        }];
        var customerJSON = JSON.stringify(parseCustomer);
        console.log(customerJSON);

        localStorage.setItem("customerName", firstname + " "+ lastname);

        return true;
      }

      $("#storePickUp").hide();

      $("#storePickUpChoice").click(function () {
        $("#homeDelivery").hide();
        $("#storePickUp").show();
        localStorage.setItem("deliveryType", "Pickup");
      });
      $("#homeDeliveryChoice").click(function () {
        $("#homeDelivery").show();
        $("#storePickUp").hide();
        localStorage.setItem("deliveryType", "Levereras");
      });

      /*
      Uppdatera Kassan
      */
      var sum = JSON.parse(localStorage.getItem("basketValue"));

      document.getElementById(
        "basketValue"
      ).innerHTML = `<b>Summa varor:</b> ${sum.toFixed(2)}  kr`;

      if (sum < 500) {
        document.getElementById("freeDelivery").innerHTML = `<b>${(
          500 - sum
        ).toFixed(2)}  kr kvar till gratis leverans</b>`;
        document.getElementById(
          "deliveryCost"
        ).innerHTML = `<b>Leverans:</b> ${JSON.parse(
          localStorage.getItem("deliveryCost")
        )} kr`;
        localStorage.setItem(
          "deliveryCost",
          JSON.parse(localStorage.getItem("deliveryCost"))
        );
      } else {
        document.getElementById("deliveryCost").innerHTML = "";
        localStorage.setItem("deliveryCost", 0);
        document.getElementById("freeDelivery").innerHTML =
          "<b>Gratis leverans </b>";
      }

      let d = JSON.parse(localStorage.getItem("deliveryCost"));
      let ta = d + sum;
      document.getElementById(
        "TotalAmount"
      ).innerHTML = `<b>Totalsumma: </b>${ta.toFixed(2)} kr`;
      localStorage.setItem("TotalAmount", ta);
    </script>
  </body>
</html>
