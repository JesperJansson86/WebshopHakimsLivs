<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6"
      crossorigin="anonymous"
    />
    <script
      src="https://code.jquery.com/jquery-3.6.0.js"
      integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
      crossorigin="anonymous"
    ></script>
    <title>Startsida</title>
  </head>
  <body class="container-fluid" style="background-color: rgb(197, 221, 197)">
    <div class="row">
      <div class="col px-0">
        <!-- Header/ huvudmenyn -->
        <header></header>
      </div>
    </div>
    <div class="row px-5">
      <div class="col-9">
        <!-- Main -->
        <div
          class="p-3 overflow-auto"
          style="background-color: rgb(197, 221, 197)"
        >
          <h2 style="color: rgb(3, 78, 3)" id="titleOfPage">
            Leverans och betalning
          </h2>
          <div class="card mb-3">
            <div class="card-header">Välj leveranssätt</div>
            <div class="card-body">
              <p style="font-weight: 500">
                Hur vill du få dina varor levererade?
              </p>

              <div id="orderSummary"></div>
              <form id="chooseDeliveryForm">
                <input
                  type="radio"
                  name="deliveryChoice"
                  id="storePickUpChoice"
                />
                Hämta i butik
                <br />
                <input
                  type="radio"
                  name="deliveryChoice"
                  id="homeDeliveryChoice"
                  checked
                />
                Hemleverans
                <br />
              </form>
              <div id="storePickUp">
                Hämtas i butik efter 12:00
                <form id="storePickUpForm" onsubmit="submitPickUp()">
                  <input
                    type="submit"
                    name="storePickUpSubmit"
                    id="storePickUpSubmit"
                    value="Beställ"
                  />
                </form>
              </div>
              <div id="homeDelivery">
                Hemleverans!<br />
                <form id="homeDeliveryForm" onsubmit="submitDelivery()">
                  <input
                    type="text"
                    name="deliveryName"
                    id="deliveryName"
                    placeholder="Ditt Namn"
                    pattern="[a-zA-ZåöäÅÖÄ]{2,30}"
                  /><br />
                  <input
                    type="text"
                    name="deliveryPhone"
                    id="deliveryPhone"
                    placeholder="Ditt telefonnummer"
                    pattern="[0-9]{5,20}"
                  /><br />
                  <input
                    type="text"
                    name="deliveryAdress"
                    id="deliveryAdress"
                    placeholder="Din Adress"
                  />
                  <br />
                  <input
                    type="submit"
                    name="deliverySubmit"
                    id="deliverySubmit"
                    value="Beställ"
                  />
                  <br />
                  Förnamn <br />
                  Efternamn <br />
                  Telefonnummer <br />
                  E-post <br /><br />

                  OM leverans <br />
                  Adress <br />
                  Postnummer <br />
                  Ort
                </form>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">Vänligen fyll i dina kontaktuppgifter</div>
            <div class="card-body">
              <!--
                    formValidation() kan ändras till passande function
                -->

              <form name="form" action="#" onsubmit="return formValidation()">
                <div class="mb-3">
                  <label for="firstname" style="font-weight: 500"
                    >Förnamn:</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="firstname"
                    placeholder="Ange förnamn"
                    name="firstname"
                    style="width: 40%"
                  />
                </div>

                <div class="mb-3">
                  <label for="lastname" style="font-weight: 500"
                    >Efternamn:</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="lastname"
                    placeholder="Ange efternamn"
                    name="lastname"
                    style="width: 40%"
                  />
                </div>

                <div class="mb-3">
                  <label for="phonenumber" style="font-weight: 500"
                    >Telefon:</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="phonenumber"
                    placeholder="Ange telefonnummer"
                    name="phonenumber"
                    style="width: 40%"
                  />
                </div>

                <div class="mb-3">
                  <label for="email" style="font-weight: 500">E-post:</label>
                  <input
                    type="email"
                    class="form-control"
                    id="email"
                    placeholder="Ange e-post"
                    name="email"
                    style="width: 40%"
                  />
                </div>

                <div class="mb-3">
                  <label for="address" style="font-weight: 500">Adress:</label>
                  <input
                    type="text"
                    class="form-control"
                    id="address"
                    placeholder="Ange adress"
                    name="address"
                    style="width: 40%"
                  />
                </div>

                <div class="mb-3">
                  <label for="zipcode" style="font-weight: 500"
                    >Postnummer:</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="zipcode"
                    placeholder="Ange postnummer"
                    name="zipcode"
                    style="width: 40%"
                  />
                </div>

                <div>
                  <label for="city" style="font-weight: 500">Ort:</label>
                  <input
                    type="text"
                    class="form-control"
                    id="city"
                    placeholder="Ange ort"
                    name="city"
                    style="width: 40%"
                  />
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
      <!-- Kassa sidebar-->
      <div class="col">
        <div class="p-3" style="background-color: rgb(136, 153, 136)">
          <h2 style="color: rgb(3, 78, 3)" id="titleOfPage">Kassan</h2>
          <div class="row">
            <div class="card-header">Sammanfattning</div>
            <div class="card-body">
              <p class="card-text" id="basketValue"></p>
              <p class="card-text" id="deliveryCost"></p>
              <p class="card-text" id="freeDelivery" style="color: greenyellow">
                Handla för minst 500 kr och få gratis leverans
              </p>
              <p class="card-text" id="TotalAmount"></p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col px-0">
        <!-- footer/ information-->
        <footer></footer>
      </div>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
      crossorigin="anonymous"
    ></script>
    <script src="../javascript/barsBasket.js"></script>
    <script>
      localStorage.setItem("deliveryType", "home");

      function submitDelivery() {
        name = document.getElementById("deliveryName").value;
        phone = document.getElementById("deliveryPhone").value;
        adress = document.getElementById("deliveryAdress").value;
        var parseCustomer = {
          name: [name],
          phone: [phone],
          adress: [adress],
        };
        var customerJSON = JSON.stringify(parseCustomer);
        //Todo vad händer här?
      }

      function submitPickUp() {
        //Todo vad händer här?
      }

      $("#storePickUp").hide();

      //Kund och beställningsdata hämtas just nu från en order.json som bör bytas ut.
      $("document").ready(function () {
        $.getJSON("order.json", function (data) {
          let total = 0;
          console.log(data);
          document.getElementById("orderSummary").innerHTML +=
            data[0].customerName;
          $.each(data[0].orderList, function (key, value) {
            document.getElementById(
              "orderSummary"
            ).innerHTML += `<br>${value.product} ${value.price}:- `;
            total += parseInt(value.price);
          });

          document.getElementById(
            "orderSummary"
          ).innerHTML += `<br> Totalt: ${total}`;
        });
      });

      $("#storePickUpChoice").click(function () {
        $("#homeDelivery").hide();
        $("#storePickUp").show();
        localStorage.setItem("deliveryType", "Pickup");
      });
      $("#homeDeliveryChoice").click(function () {
        $("#homeDelivery").show();
        $("#storePickUp").hide();
        localStorage.setItem("deliveryType", "home");
      });

      var sum = JSON.parse(localStorage.getItem("basketValue"));

      document.getElementById(
        "basketValue"
      ).innerHTML = `<b>Summa varor:</b> ${sum.toFixed(2)}  kr`;

      if (sum < 500) {
        document.getElementById("freeDelivery").innerHTML = `<b>${(
          500 - sum
        ).toFixed(2)}  kr kvar till gratis leverans</b>`;
        document.getElementById(
          "deliveryCost"
        ).innerHTML = `<b>Leverans:</b> ${JSON.parse(
          localStorage.getItem("deliveryCost")
        )} kr`;
        localStorage.setItem(
          "deliveryCost",
          JSON.parse(localStorage.getItem("deliveryCost"))
        );
      } else {
        document.getElementById("deliveryCost").innerHTML = "";
        localStorage.setItem("deliveryCost", 0);
        document.getElementById("freeDelivery").innerHTML =
          "<b>Gratis leverans </b>";
      }

      let d = JSON.parse(localStorage.getItem("deliveryCost"));
      let ta = d + sum;
      document.getElementById(
        "TotalAmount"
      ).innerHTML = `<b>Totalsumma: </b>${ta.toFixed(2)} kr`;
      localStorage.setItem("TotalAmount", ta);
    </script>
  </body>
</html>
